@using System.Data;
@using System.Data.OleDb;
@using System.Web.UI.WebControls
@using IdealMall.Common
@using IdealMall.Entities

@model IdealMall.Entities.LocalShopsOffers
@{
    Layout = null;
    ViewBag.ID = "Product";
    List<IdealMall.Entities.PublicOffer> Offer_Weekly = Model.Offers.Where(M => M.Offer_Mode == "W").ToList();
    List<IdealMall.Entities.PublicOffer> Offer_Monthly = Model.Offers.Where(M => M.Offer_Mode == "M").ToList();
    List<IdealMall.Entities.PublicOffer> Offer_New = Model.Offers.Where(M => M.Offer_Mode == "N").ToList();
    List<IdealMall.Entities.PublicOffer> Offer_Best = Model.Offers.Where(M => M.Offer_Mode == "B").ToList();
}
<!DOCTYPE html>
<!--[if lt IE 8]> <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]> <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]> <html class="no-js ie9 oldie" lang="en"> <![endif]-->
<!--[if gt IE 9]><!-->
@*<html class='no-js' lang='en'>*@
<style>

</style>

<!--[if IE]>
            <link rel="stylesheet" href="@Url.Content("~/Content/ie.css")" type="text/css" media="all" />
        <![endif]-->


<html class='no-js' lang='en'>
<!--<![endif]-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Londis Convenience Store</title>

    <link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon" />
    <link href="@Url.Content("~/Content/reset.css")" rel="stylesheet" type="text/css" media="all" />
    <link href="@Url.Content("~/Content/style.css")" rel="stylesheet" type="text/css" media="all" />
    <link href="@Url.Content("~/Content/colorbox.css")" rel="stylesheet" type="text/css" media="all" />
    <!--[if IE]>
<link rel="stylesheet" href="css/ie.css" type="text/css" media="all" />
<![endif]-->
</head>

<body>
    <!----Header --------------->
    @Html.Partial("LoginPartial", new PublicUser()
{
    EmailAddress = Request.Cookies["EmailAddress"] != null ? Request.Cookies["EmailAddress"].Value : string.Empty,
    Password = Request.Cookies["Password"] != null ? Request.Cookies["Password"].Value : string.Empty,
    RememberMe = Request.Cookies["RememberMe"] != null ? Convert.ToBoolean(Request.Cookies["RememberMe"].Value) : false
})
    <div class="headerbg clearfix">
        <div class="pagewidth clearfix headertop">
            <div class="email-phone"><a class="phone" href="tel:+020-8478-4878">020 8478 4878</a> | <a class="email" href="mailto:londismanopark@gmail.com">londismanopark@gmail.com</a> </div>
            <div class="usersubmenu">
                <div class="submenubtm">
                    @if (string.IsNullOrWhiteSpace(ViewBag.PublicUserName))
                    {
                        <label></label>
                    }
                    else
                    {
                        <label>Welcome @ViewBag.PublicUserFirstName @ViewBag.PublicUserLastName!</label>
                    }
                    <span>|  </span>

                    @{
                        string visibleWithLoginDiv = "none";
                        string visibleWithOutLoginDiv = "none";

                        if (ViewBag.PublicUserName == string.Empty)
                        {
                            visibleWithOutLoginDiv = "inline-block";
                        }
                        else
                        {
                            visibleWithLoginDiv = "inline-block";
                        }
                    
                    }
                    <div id="withoutlogin" style="display:@visibleWithOutLoginDiv" >@Html.ActionLink("Sign In", "LoginIndex", "home") </div>
                    <div id="withlogin" style="display:@visibleWithLoginDiv" >@Html.ActionLink("Sign Out", "SignOut", "Home") </div>
                    <span>| </span><a href="Contact.html" class="contact-icon">@Html.ActionLink("Contact Us", "ContactUsIndex", "Public")</a>
                </div>
            </div>
        </div>
        <div class="pagewidth">
            <div class="logo">
                <a href="Home.html" title="Londis Convenience Store"><span>Londis Convenience Store</span></a>
                <p class="logoslogan">Londis Convenience Store</p>
                <p>128-130 Church Road, Manor Park, London E12 6HL</p>
            </div>
            <div class="controls">
                <input type="text" id="query" name="query" class="jq_watermark" value="@ViewBag.searchtext" size="100" placeholder="Product Search" autofocus="true" />
                <input type="submit" id="searchbutton" onclick="Javascript: QueryClick();" value="" class="search-icon" />
                <input type="hidden" name="browser" value="full" />
            </div>
            <div class="shopping-info">
                <div class="lftbx" onclick="Javascript:ShoppingCartClick();">
                    <div class="fst-p">@Html.ActionLink("Shopping Cart", "Index", "PublicShopping")</div>
                    @{
                        decimal totalamount = 0;
                        string itemlist = string.Empty;
                        if (ViewBag.ShopSummaries != null)
                        {
                            foreach (var item in (List<ShoppingSummary>)ViewBag.ShopSummaries)
                            {
                                totalamount += item.TotalPurchaseAmount;
                            }
                            itemlist = ViewBag.ShoppingCount + " Items" + "- £" + Math.Round(totalamount, 2);
                        }
                        else
                        {
                            itemlist = "0" + " Items" + "- £" + "0.00";
                        }
                        <p onclick="Javascript:ShoppingCartClick();" id="Shop_Items">@itemlist</p>
                    }

                </div>
                <div class="shopping-icon" onclick="Javascript:ShoppingCartClick();">
                    @if (ViewBag.ShoppingCount == null)
                    {
                        <span>0</span>
                    }
                    else
                    {
                        <span id="Shop_Count">@ViewBag.ShoppingCount </span>
                    }

                    <a href="#"></a>
                </div>
            </div>
        </div>
    </div>
    <!----Header ends--------------->

    <!----Contents Starts--------------->
    <div class="section">
        <div class="pagewidth clearfix">
            <div class="leftnav ">
                <h1>Categories</h1>
                @{
                    DataSet DtSet = null;
                    int tableCount = 0;
                    int table1RowCount = 0;
                    int table2RowCount = 0;
                    string currDepartment = string.Empty;
                    string oldDepartment = string.Empty;
                    string currCategory = string.Empty;
                    string oldCategory = string.Empty;
                    try
                    {
                        OleDbConnection MyConnection = null;

                        OleDbDataAdapter MyCommand;
                        // need to pass relative path after deploying on server
                        string excelPath = System.IO.Path.GetFullPath(Server.MapPath("~/Content/CategoryMenu/MenuProducts.xls"));

                        /* connection string  to work with excel file. HDR=Yes - indicates 
               that the first row contains columnnames, not data. HDR=No - indicates 
               the opposite. "IMEX=1;" tells the driver to always read "intermixed" 
               (numbers, dates, strings etc) data columns as text. 
            Note that this option might affect excel sheet write access negative. */

                        if (Path.GetExtension(excelPath) == ".xls")
                        {
                            MyConnection = new OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + excelPath + ";Extended Properties=\"Excel 8.0;HDR=Yes;IMEX=2\"");
                        }
                        else if (Path.GetExtension(excelPath) == ".xlsx")
                        {
                            MyConnection = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + excelPath + ";Extended Properties='Excel 12.0;HDR=YES;IMEX=1;';");
                        }


                        //MyConnection = new OleDbConnection("provider=Microsoft.Jet.OLEDB.4.0;Data Source='c:\\csharp.net-informations.xls';Extended Properties=Excel 8.0;");
                        MyCommand = new OleDbDataAdapter("select * from [Department1$]", MyConnection);
                        //MyCommand.TableMappings.Add("Table1", "TestTable1");
                        DtSet = new System.Data.DataSet();
                        MyCommand.Fill(DtSet, "Department1");

                        MyCommand = new OleDbDataAdapter("select * from [Department2$]", MyConnection);
                        //MyCommand.TableMappings.Add("Table2", "TestTable2");
                        MyCommand.Fill(DtSet, "Department2");

                        tableCount = DtSet.Tables.Count;
                        if (tableCount > 0)
                        {
                            if (DtSet.Tables[0].Rows != null)
                            {
                                table1RowCount = DtSet.Tables[0].Rows.Count;
                            }
                            if (tableCount > 1)
                            {
                                if (DtSet.Tables[1].Rows != null)
                                {
                                    table2RowCount = DtSet.Tables[1].Rows.Count;
                                }
                            }
                        }
                        MyConnection.Close();
                    }
                    catch (Exception ex)
                    {
                    }
                    <div>
                        <ul>
                            @if (table1RowCount > 0)
                            {

                                for (int i = 0; i < table1RowCount; i++)
                                {
                                    currDepartment = DtSet.Tables[0].Rows[i][0].ToString();
                                    if (currDepartment != oldDepartment)
                                    {
                                        string filter = "Department = '" + currDepartment + "'";
                                        DataRow[] result = DtSet.Tables[0].Select(filter);
                                        int filterCount = result.Length;
                                <li><a href="javascript:void(0);">@currDepartment<span class="arrow"></span></a>
                                    <ul>
                                        @foreach (DataRow row in result)
                                        {
                                            currCategory = row[1].ToString();
                                            <li><a href="javascript:void(0);" category-name="@currCategory" onclick=" javascript:getCategoryProducts(this); ">
                                                @currCategory</a></li>
                                        }
                                    </ul>
                                </li>
                                    }
                                    oldDepartment = currDepartment;
                                }

                            }


                            @if (table2RowCount > 0)
                            {

                                for (int i = 0; i < table2RowCount; i++)
                                {
                                    currDepartment = DtSet.Tables[1].Rows[i][0].ToString();
                                    if (currDepartment != oldDepartment)
                                    {
                                        string filter = "Department = '" + currDepartment + "'";
                                        DataRow[] result = DtSet.Tables[1].Select(filter);
                                        int filterCount = result.Length;
                                <li><a href="javascript:void(0);">@currDepartment<span class="arrow"></span></a>
                                    <ul>
                                        @foreach (DataRow row in result)
                                        {
                                            currCategory = row[1].ToString();
                                            <li><a href="javascript:void(0);" category-name="@currCategory" onclick=" javascript:getCategoryProducts(this); ">
                                                @currCategory
                                            </a></li>
                                        }
                                    </ul>
                                </li>
                                    }
                                    oldDepartment = currDepartment;
                                }

                            }
                        </ul>
                    </div>
                }


            </div>
            <!----LeftNAv ends--------------->
            <!----article Starts--------------->
            <div class="article">
                <div class="mainnav">
                    <ul>
                        <li><a href="#" class="active">HOME</a></li>
                        <li><a href="#" onclick="javascript:SearchClick('W');">WEEKLY SPECIAL </a></li>
                        <li><a href="#" onclick="javascript:SearchClick('M');">MONTHLY SPECIAL</a></li>
                        <li><a href="#" onclick="javascript:SearchClick('N');">NEW ARRIVALS</a></li>
                        <li><a href="#" onclick="javascript:SearchClick('');">ALL PRODUCTS</a></li>
                    </ul>
                </div>
                <!--Slider-->
                <section class="bannerbg clearfix">
                    <div id="banner_fade">
                        <ul class="bjqs">
                            <li>
                                <div>
                                    <img src="../../img/banner1.jpg" border="0" alt="" style="display: block;" />
                                </div>
                            </li>
                            <li>
                                <div>
                                    <img src="../../img/banner2.jpg" border="0" alt="" style="display: block;" />
                                </div>
                            </li>
                            <li>
                                <div>
                                    <img src="../../img/banner3.jpg" border="0" alt="" style="display: block;" />
                                </div>
                            </li>
                            <li>
                                <div>
                                    <img src="../../img/banner4.jpg" border="0" alt="" style="display: block;" />
                                </div>
                            </li>
                            <li>
                                <div>
                                    <img src="../../img/banner5.jpg" border="0" alt="" style="display: block;" />
                                </div>
                            </li>
                            <li>
                                <div>
                                    <img src="../../img/banner6.jpg" border="0" alt="" style="display: block;" />
                                </div>
                            </li>
                            <li>
                                <div>
                                    <img src="../../img/banner7.jpg" border="0" alt="" style="display: block;" />
                                </div>
                            </li>
                            <li>
                                <div>
                                    <img src="../../img/banner8.jpg" border="0" alt="" style="display: block;" />
                                </div>
                            </li>
                            <li>
                                <div>
                                    <img src="../../img/banner9.jpg" border="0" alt="" style="display: block;" />
                                </div>
                            </li>
                            <li>
                                <div>
                                    <img src="../../img/banner10.jpg" border="0" alt="" style="display: block;" />
                                </div>
                            </li>
                        </ul>
                    </div>
                </section>
                <!--Slider Ends-->

                <!----rightNav Starts--------------->
                <div class="rightnav ">
                    <a href="#">
                        <img src="../../img/rgt-ad-img.jpg" border="0" alt="" style="display: block;" /></a>
                </div>
                <!----rightNav ends--------------->
                <div class="clearfix"></div>
                <div class="tabbed">
                    <ul id="tabs">
                        <li class="active">NEW ARRIVALS</li>
                        <li>WEEKLY SPECIAL </li>
                        <li>MONTHLY SPECIAL</li>
                        <li>BEST SELLERS</li>
                    </ul>
                    <ul id="tab">
                        <li class="active">
                            @{
                                
                                for (int i = 0; i < 12; i++)
                                {
                                    string classname = "product-block";
                                    if ((i + 1) % 3 == 0)
                                    {
                                        classname = "product-block clearfix";
                                    }
                                <div class="@classname ">

                                    <div class="productbox">

                                        <div class="productdetails">
                                            @if (Offer_New[i].Product.Length > 41)
                                            {
                                                <h1><span>@Offer_New[i].Product</span><span style="display: inline"> (@Offer_New[i].Volume) </span></h1>
                                            }
                                            else
                                            {
                                                <h1><span data-role="product">@Offer_New[i].Product</span><span style="display: block"> (@Offer_New[i].Volume) </span></h1>
                                            }
                                            @if (Offer_New[i].OfferRate != 0)
                                            {
                                                string strSellPrice = string.Empty;
                                                if (Convert.ToDecimal(Offer_New[i].OfferRate) < 1)
                                                {
                                                    strSellPrice = (Convert.ToDecimal(Offer_New[i].OfferRate) * 100).ToString().TrimEnd('0').TrimEnd('.') + "p";
                                                }
                                                else
                                                {
                                                    strSellPrice = "£" + Offer_New[i].OfferRate;
                                                }
                                                <div class="pro-details">
                                                    <h2>@strSellPrice</h2>
                                                </div>
                                            }
                                            <div class="pro-image">
                                                <img src="@Url.Content(Offer_New[i].ImageURL)" border="0" alt="@Offer_New[i].Product" class="zoom_01" data-zoom-image="@Url.Content(Offer_New[i].ImageURL)" />
                                            </div>
                                            <div class="qty-cart">
                                                <div class="input">
                                                    <label>Quantity</label>
                                                    <input type="text" value="1" data-role="Qty" style="width: 50px;" />
                                                </div>
                                                <div class="cart"><a href="javascript:void(0);" class="addtocart" onmousedown="shoppingAddKeyDown(this);" onclick=" AddToShoppingList(this, '@ViewBag.PublicUserName'); ">Add To Cart</a></div>
                                                <input type="hidden" data-role="shopid" value="@Offer_New[i].Shop.ID" />
                                                <input type="hidden"  data-role="vat" value="@Offer_New[i].VAT" />
                                                <input type="hidden" data-role="offerrate" value="@Offer_New[i].OfferRate" />
                                                <input type="hidden"  data-role="volume" value="@Offer_New[i].Volume" />
                                            </div>
                                            @*  <h3>Offer valid until: @Offer_New[i].OfferEnddate</h3>*@
                                        </div>
                                    </div>
                                </div>
                                }
                            }
                            <div class="seemore"><a href="javascript:void(0);" onclick="javascript:SearchClick('N');">See More Products ></a></div>
                        </li>
                        <li>
                            @{
                                
                                for (int i = 0; i < 12; i++)
                                {
                                    string classname = "product-block";
                                    if ((i + 1) % 3 == 0)
                                    {
                                        classname = "product-block clearfix";
                                    }
     
                                <div class="@classname">

                                    <div class="productbox">

                                        <div class="productdetails">
                                            @if (Offer_Weekly[i].Product.Length > 41)
                                            {
                                                <h1><span>@Offer_Weekly[i].Product</span><span style="display: inline"> (@Offer_Weekly[i].Volume) </span></h1>
                                            }
                                            else
                                            {
                                                <h1><span data-role="product">@Offer_Weekly[i].Product</span><span style="display: block"> (@Offer_Weekly[i].Volume) </span></h1>
                                            }
                                            @if (Offer_Weekly[i].OfferRate != 0)
                                            {
                                                string strSellPrice = string.Empty;
                                                if (Convert.ToDecimal(Offer_Weekly[i].OfferRate) < 1)
                                                {
                                                    strSellPrice = (Convert.ToDecimal(Offer_Weekly[i].OfferRate) * 100).ToString().TrimEnd('0').TrimEnd('.') + "p";
                                                }
                                                else
                                                {
                                                    strSellPrice = "£" + Offer_Weekly[i].OfferRate;
                                                }
                                                <div class="pro-details">
                                                    <h2>@strSellPrice</h2>
                                                    @if (Convert.ToString(Offer_Weekly[i].Previous_Prize) != string.Empty)
                                                    {
                                                        if (Convert.ToDecimal(Offer_Weekly[i].Previous_Prize) > 0)
                                                        {
                                                        <h2 class="rmbold">(Was <span class="line-through">£ @Offer_Weekly[i].Previous_Prize</span>)</h2>

                                                        }
                                                    }
                                                </div>
                                               
                                            }
                                            <div class="pro-image">

                                                <img src="@Url.Content(Offer_New[i].ImageURL)" border="0" alt="@Offer_New[i].Product " class="zoom_01" data-zoom-image="@Url.Content(Offer_New[i].ImageURL)"/>

                                            </div>
                                            <div class="qty-cart">
                                                <div class="input">
                                                    <label>Quantity</label>
                                                    <input type="text" value="1" data-role="Qty" style="width: 50px;" />
                                                </div>
                                                <div class="cart"><a href="javascript:void(0);" class="addtocart" onmousedown="shoppingAddKeyDown(this);" onclick=" AddToShoppingList(this, '@ViewBag.PublicUserName'); ">Add To Cart</a></div>
                                                <input type="hidden" data-role="shopid" value="@Offer_Weekly[i].Shop.ID" />
                                                <input type="hidden"  data-role="vat" value="@Offer_Weekly[i].VAT" />
                                                <input type="hidden" data-role="offerrate" value="@Offer_Weekly[i].OfferRate" />
                                                <input type="hidden"  data-role="volume" value="@Offer_Weekly[i].Volume" />
                                            </div>
                                            <h3>Offer valid until:<span> @Offer_Weekly[i].OfferEnddate</span></h3>
                                        </div>
                                    </div>
                                </div>
                                }
                            }
                            <div class="seemore"><a href="javascript:void(0);" onclick="javascript:SearchClick('W');">See More Products ></a></div>
                        </li>
                        <li>
                            @{
                                
                                for (int i = 0; i < 12; i++)
                                {
                                    string classname = "product-block";
                                    if ((i + 1) % 3 == 0)
                                    {
                                        classname = "product-block clearfix";
                                    }
                                <div class="@classname">

                                    <div class="productbox">

                                        <div class="productdetails">
                                            @if (Offer_Monthly[i].Product.Length > 41)
                                            {
                                                <h1><span>@Offer_Monthly[i].Product</span><span style="display: inline"> (@Offer_Monthly[i].Volume) </span></h1>
                                            }
                                            else
                                            {
                                                <h1><span data-role="product">@Offer_Monthly[i].Product</span><span style="display: block"> (@Offer_Monthly[i].Volume) </span></h1>
                                            }
                                            @if (Offer_Monthly[i].OfferRate != 0)
                                            {
                                                string strSellPrice = string.Empty;
                                                if (Convert.ToDecimal(Offer_Monthly[i].OfferRate) < 1)
                                                {
                                                    strSellPrice = (Convert.ToDecimal(Offer_Monthly[i].OfferRate) * 100).ToString().TrimEnd('0').TrimEnd('.') + "p";
                                                }
                                                else
                                                {
                                                    strSellPrice = "£" + Offer_Monthly[i].OfferRate;
                                                }
                                                <div class="pro-details">
                                                    <h2>@strSellPrice</h2>
                                                    @if (Convert.ToString(Offer_Monthly[i].Previous_Prize) != string.Empty)
                                                    {
                                                        if (Convert.ToDecimal(Offer_Monthly[i].Previous_Prize) > 0)
                                                        {
                                                        <h2 class="rmbold">(Was <span class="line-through">£ @Offer_Monthly[i].Previous_Prize</span>)</h2>

                                                        }
                                                    }
                                                </div>
                                               
                                            }
                                            <div class="pro-image">


                                                <img src="@Url.Content(Offer_New[i].ImageURL)" border="0" alt="@Offer_New[i].Product " class="zoom_01" data-zoom-image="@Url.Content(Offer_New[i].ImageURL)" />

                                            </div>
                                            <div class="qty-cart">
                                                <div class="input">
                                                    <label>Quantity</label>
                                                    <input type="text" value="1" data-role="Qty" style="width: 50px;" />
                                                </div>
                                                <div class="cart"><a href="javascript:void(0);" class="addtocart" onmousedown="shoppingAddKeyDown(this);" onclick=" AddToShoppingList(this, '@ViewBag.PublicUserName'); ">Add To Cart</a></div>
                                                <input type="hidden" data-role="shopid" value="@Offer_Monthly[i].Shop.ID" />
                                                <input type="hidden"  data-role="vat" value="@Offer_Monthly[i].VAT" />
                                                <input type="hidden" data-role="offerrate" value="@Offer_Monthly[
                                                i].OfferRate" />
                                                <input type="hidden"  data-role="volume" value="@Offer_Monthly[i].Volume" />
                                            </div>
                                            <h3>Offer valid until:<span> @Offer_Monthly[i].OfferEnddate</span></h3>
                                        </div>
                                    </div>
                                </div>
                                }
                            }
                            <div class="seemore"><a href="javascript:void(0);" onclick="javascript:SearchClick('M');">See More Products > </a></div>
                        </li>
                        <li>
                            @{
                                
                                for (int i = 0; i < 12; i++)
                                {
                                    string classname = "product-block";
                                    if ((i + 1) % 3 == 0)
                                    {
                                        classname = "product-block clearfix";
                                    }
                                <div class="@classname">

                                    <div class="productbox">

                                        <div class="productdetails">
                                            @if (Offer_Best[i].Product.Length > 41)
                                            {
                                                <h1><span>@Offer_Best[i].Product</span><span style="display: inline"> (@Offer_Best[i].Volume) </span></h1>
                                            }
                                            else
                                            {
                                                <h1><span data-role="product">@Offer_Best[i].Product</span><span style="display: block"> (@Offer_Best[i].Volume) </span></h1>
                                            }
                                            @if (Offer_Best[i].OfferRate != 0)
                                            {
                                                string strSellPrice = string.Empty;
                                                if (Convert.ToDecimal(Offer_Best[i].OfferRate) < 1)
                                                {
                                                    strSellPrice = (Convert.ToDecimal(Offer_Best[i].OfferRate) * 100).ToString().TrimEnd('0').TrimEnd('.') + "p";
                                                }
                                                else
                                                {
                                                    strSellPrice = "£" + Offer_Best[i].OfferRate;
                                                }
                                                <div class="pro-details">
                                                    <h2>@strSellPrice</h2>
                                                </div>
                                            }
                                            <div class="pro-image">

                                                <img src="@Url.Content(Offer_New[i].ImageURL)" border="0" alt="@Offer_New[i].Product "  class="zoom_01" data-zoom-image="@Url.Content(Offer_New[i].ImageURL)" />

                                            </div>
                                            <div class="qty-cart">
                                                <div class="input">
                                                    <label>Quantity</label>
                                                    <input type="text" value="1" data-role="Qty" style="width: 50px;" />
                                                </div>
                                                <div class="cart"><a href="javascript:void(0);" class="addtocart" onmousedown="shoppingAddKeyDown(this);" onclick=" AddToShoppingList(this, '@ViewBag.PublicUserName'); ">Add To Cart</a></div>
                                                <input type="hidden" data-role="shopid" value="@Offer_Best[i].Shop.ID" />
                                                <input type="hidden"  data-role="vat" value="@Offer_Best[i].VAT" />
                                                <input type="hidden" data-role="offerrate" value="@Offer_Best[i].OfferRate" />
                                                <input type="hidden"  data-role="volume" value="@Offer_Best[i].Volume" />
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                }
                            }
                            <div class="seemore"><a href="javascript:void(0);" onclick="javascript:SearchClick('B');">See More Products ></a></div>
                        </li>

                    </ul>
                </div>
                <div class="rightnav ">
                    <a href="#">
                        <img src="../../img/rgt-ad-img.jpg" border="0" alt="" style="display: block;" /></a>
                </div>
            </div>
            <!----article ends--------------->

        </div>
    </div>

    <!----Contents ends--------------->

    <div class="section ">
        <div class="pagewidth clearfix">
            <!-- Scroller DOM starts-->
            <div class="scrollerbg">
                <div class="slider-container" id="jssor_1" style="">
                    <div data-u="slides" class="slider-box" style="">
                        <div>
                            <a href="#">
                                <img src="../../img/1.png"></a>
                        </div>

                        <div>
                            <a href="#">
                                <img src="../../img/3.png"></a>
                        </div>
                        <div>
                            <a href="#">
                                <img src="../../img/4.png"></a>
                        </div>
                        <div>
                            <a href="#">
                                <img src="../../img/5.png"></a>
                        </div>
                        <div>
                            <a href="#">
                                <img src="../../img/6.png"></a>
                        </div>
                        <div>
                            <a href="#">
                                <img src="../../img/7.png"></a>
                        </div>
                        <div>
                            <a href="#">
                                <img src="../../img/8.png"></a>
                        </div>
                        <div>
                            <a href="#">
                                <img src="../../img/9.png"></a>
                        </div>
                        <div>
                            <a href="#">
                                <img src="../../img/10.png"></a>
                        </div>

                    </div>
                </div>
            </div>
            <!-- Scroller DOM ends-->

        </div>
    </div>
    <!----Contents ends--------------->

    <!----Footer Starts--------------->
    <div class="footerbg clearfix">
        <div class="pagewidth clearfix">
            <div class="logo">
                <a href="Home.html" title="Londis"><span>Londis Logo</span></a>
                <p class="logoslogan">Londis Convenience Store</p>
                <p class="addr-footer">
                    128-130 Church Road,<br />
                    Manor Park,<br />
                    London E12 6HL
                </p>
            </div>

            <div class="footermenus">
                <h2>Company</h2>
                <ul>
                    <li><a href="javascript:void(0);">About Us</a></li>
                    <li><a href="javascript:void(0);">Terms and Conditions</a></li>
                    <li><a href="Contact.html">Contact Us</a></li>
                </ul>
            </div>



            <div class="copyright clearfix">

                <div class="powered">Powered by</div>
                <a href="javascript:void(0);" title="Deal Z Local" class="footerlogo"></a>
                <p class="addr-footer">
                    128-130 Church Road,<br />
                    Manor Park,<br />
                    London E12 6HL
                </p>
            </div>
            <div class="copyright clearfix">
                <h2>PROMOTION LEAFLET</h2>
                <div class="controls">
                    <input type="text" class="jq_watermark" placeholder="Email address" />
                    <input type="submit" value="ok" />
                </div>

                <div class="socialicons">
                    <div class="label">Follow Us</div>
                    <a href="javascript:void(0);" title="Facebook" class="facebook"></a><a href="javascript:void(0);" title="Twitter" class="twitter"></a><a href="javascript:void(0);" title="Googleplus" class="googleplus"></a><a href="javascript:void(0);" title="Youtube" class="youtube"></a>
                </div>
            </div>
            <div class="clearfix">
            </div>
            <div class="footernav clearfix">
                <a href="Contact.html">CONTACT US</a> | 
                <a href="#">ABOUT US</a> | 
                <a href="#">TERMS & CONDITIONS</a> | 
                <a href="#">PAYMENTS</a> | 
                <a href="#">MT ORDERS</a> | 
                <a href="#">MY ACCOUNT</a>
                <p>Copyright &copy; 2016 Church Road Londis. All Rights Reserved</p>
            </div>
        </div>
    </div>

    <!----Footer Ends--------------->


    <script src="@Url.Content("~/Scripts/jquery-1.11.2.min.js")" type="text/javascript"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/jquery.elevateZoom-3.0.8.min.js")"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.nicescroll.js")" type="text/javascript"></script>
    <link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="@Url.Content("~/Scripts/jquery.watermark.min.js")"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/slider-1.3.min.js")" type="text/javascript"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/custom-form-elements.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/jquery.colorbox-min.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/jssor.slider.mini.js")"></script>
    <script src="@Url.Content("~/Scripts/common.js")" type="text/javascript"></script>



    <script type="text/javascript">

        function SearchClick(Mode) {
            selectskin();
            window.location = "@Url.Action("DirectPublic", "Public")?Mode=" + Mode + "&" + "page=" + "1";
        }

        function getCategoryProducts(ctrl) {
            var category = $(ctrl).attr("category-name");
            $("#query").val($(ctrl).attr("category-name"));
            //var cashandcarry = $("#selectedcompany").val();
            var cashandcarry = "1";
            window.location = "@Url.Action("HomeDirectPublic", "Public")?Mode=" + "" + "&" + "query=" + category + "&page=1";
        }

        function ShoppingCartClick() {
            window.location = "@Url.Action("Index", "PublicShopping")";
        }

        function getresult(val, cashcarry, browser, Offer_Mode) {
            $("#loading").css("display", "block");
            $.ajax({
                cache: false,
                async: true,
                type: "POST",
                url: "@(Url.Action("HomeDirectPublic", "Public"))",
                data: { "Mode": Offer_Mode, "query": val },

                success: function (data) {
                    if (browser != null) {
                        $('#publicbody').html(data);
                    }
                    else {
                        $('#searchresult').html(data);
                    }
                    $("#loading").css("display", "none");
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    $("#loading").css("display", "none");
                    if (xhr.status == 401) {
                        window.location.href = "@(Url.Action("Index", "Home"))";
                }
                }
            });
    }



    $(document).ready(
    function () {
        totalpages = '@ViewBag.pages';

        $("#query").keydown(function (e) {

            if (e.keyCode == 13) {
                window.location = "@Url.Action("HomeDirectPublic", "Public")?Mode=" + "" + "&" + "query=" + $("#query").val();
            }
        });


        $("#query").autocomplete({
            source: function (request, response) {

                var customer = new Array();
                $.ajax({
                    async: false,
                    cache: false,
                    type: "POST",
                    url: "@(Url.Action("Autocomplete", "Public"))",
                    data: { "term": request.term },
                    success: function (data) {

                        for (var i = 0; i < data.length; i++) {
                            customer[i] = { label: data[i].Value, Id: data[i].Key };
                        }
                    }
                });
                response(customer);
            },
            select: function (event, ui) {
                //fill selected customer details on form
                window.location = "@Url.Action("HomeDirectPublic", "Public")?Mode=" + "" + "&" + "query=" + ui.item.label;
            },
            error: function (xhr, ajaxOptions, thrownError) {
                //debugger;
                if (xhr.status == 401) {
                    window.location.href = "@(Url.Action("Index", "Home"))";
                }
            }
        });

        $("#searchbutton").click(function (e) {
            window.location = "@Url.Action("HomeDirectPublic", "Public")?Mode=" + "" + "&" + "query=" + $("#query").val();
        });

        $(".zoom_01").elevateZoom({
            borderColour: '#ccc',
            zoomWindowFadeIn: 500,
            zoomWindowFadeOut: 500,
            lensFadeIn: 500,
            lensFadeOut: 500,
            zoomWindowHeight: 300,
            zoomWindowWidth: 300,
            zoomWindowPosition: 10
        });


        /*Slider*/
        $('#banner_fade').bjqs({
            height: 437,
            width: 850,
            responsive: true,
            animduration: 500,
            animspeed: 2500
        });


        /*****Logo Scroller*******/
        var jssor_1_options = {
            $AutoPlay: true,
            $Idle: 0,
            $AutoPlaySteps: 4,
            $SlideDuration: 1600,
            $SlideEasing: $Jease$.$Linear,
            $PauseOnHover: 4,
            $SlideWidth: 190,
            $Cols: 7
        };

        var jssor_1_slider = new $JssorSlider$("jssor_1", jssor_1_options);
        /*****Logo Scroller ends*******/

        $(".pager a").click(function (e) {
            e.preventDefault();
            var txt = $(e.target).text();
            if (txt == '«') {
                txt = $(".current").text();
                var numPrev = parseInt(txt);
                numPrev -= 1;
                txt = numPrev;
            }
            if (txt == '»') {
                txt = $(".current").text();
                var numNext = parseInt(txt);
                numNext += 1;
                txt = numNext;
            }
            refreshproducts("@ViewBag.cc", txt);
        });

        $("[data-role='Qty']").keydown(function (e) {
            if (e.keyCode == 13) {
                AddToShoppingList(this);
                return;
            }
            // Allow: backspace, delete, tab, escape and enter
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13]) !== -1 ||
                // Allow: Ctrl+A
                (e.keyCode == 65 && e.ctrlKey === true) ||
                // Allow: home, end, left, right
                (e.keyCode >= 35 && e.keyCode <= 39)) {
                // let it happen, don't do anything
                return;
            } x
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
    });

    function AddToShoppingList(button, userName) {

        if (userName == '') {
            $.colorbox(
            {
                href: '#partiallogin',
                inline: true,
                width: '800px',
                escKey: true,
                opacity: 0.50,
                overlayClose: false,
                onClosed: function () {
                    if ($("#loginstatus").val() == 'loggedin') {
                        AddToShoppingList(button, 'success');
                    }
                }
            });
            return false;
        }
        var divmain = $(button).parents("div .productbox").first();
        var Qty = $(divmain).find("[data-role='Qty']").val();
        if (Qty != "") {
            var volume = $(divmain).find("[data-role='volume']").val();
            //var shopid = $(divmain).find("[data-role='shopid']").val();
            //  var vat = $(divmain).find("[data-role='vat']").val();
            var offerrate = $(divmain).find("[data-role='offerrate']").val();
            var product = $(divmain).find("[data-role='product']").text().trim();
            $("#loading").css("display", "block");
            $.ajax({
                cache: false,
                async: false,
                type: "POST",
                url: "@(Url.Action("AddToShoppingList", "Public"))",
                data: { "UserId": "IdealMall", "Shop_ID": "1", "Offer_Rate": offerrate, "Product": product, "Qty": Qty, "VAT": "", "Volume": volume },
                success: function (data) {
                    if (data == "Session Time out") {
                        window.location.href = "@(Url.Action("Index", "Home"))";
                        return;
                    }
                    ShoppingListSuccess(data);
                    if (userName == 'success') {
                        window.location.href = "@(Url.Action("Index", "Home"))";
                    }
                    $("#withlogin").css('visibility', 'visible');
                    $("#withoutlogin").css('visibility', 'hidden');
                    //$("#withoutlogin").hide();
                    button.text = "Add to Cart";
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    if (xhr.status == 401) {
                        window.location.href = "@(Url.Action("Index", "Home"))";
                }
                    $("#loading").css("display", "none");
                    button.text = "Add to Cart";
                }
            });
    }
}

function ShoppingListSuccess(data) {
    $("#loading").css("display", "block");
    $("#shoppinglistcount").text("(" + data + ")");
    $.ajax({
        cache: false,
        async: false,
        type: "POST",
        url: "@(Url.Action("GetShoppingList", "Public"))",
        data: { "UserId": "IdealMall" },
        success: function (jsonData) {
            $("#shopsummary").html("");
            var ul = $("<ul></ul>").appendTo("#shopsummary");
            var total = 0;
            $.each(jsonData, function (i, value) {
                var li = $("<li></li>").appendTo(ul);
                var a = $("<a href='javascript:void(0);'></a>");
                $("<img src='" + value.ShopImgUrl + "' alt='" + value.ShopName + "'/>").appendTo(a);
                a.appendTo(li);
                $("<span></span>").text("£" + value.TotalPurchaseAmount).appendTo(li);
                total += value.TotalPurchaseAmount;
            });
            if (total > 0) {
                $("#Shop_Items").text(data + " Items" + "-" + "£" + total.toFixed(2));
                $("#Shop_Count").text(data);
            }
            $("#loading").css("display", "none");
        },
        error: function (xhr, ajaxOptions, thrownError) {
            if (xhr.status == 401) {
                window.location.href = "@(Url.Action("Index", "Home"))";
        }
            $("#loading").css("display", "none");
        }
    });

}

function shoppingAddKeyDown(shopAddBtn) {

    shopAddBtn.text = 'Adding...';
}
    </script>


</body>
</html>
